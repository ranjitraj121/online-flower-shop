"use strict";function latepoint_is_timeframe_in_periods(e,t,a,o){for(var n=arguments.length>3&&void 0!==o&&o,s=0;s<a.length;s++){var i=0,r=0,l=0,c=0,d=a[s].split(":");if(2==d.length?(i=d[0],r=d[1]):(l=d[2],c=d[3],i=parseFloat(d[0])-parseFloat(l),r=parseFloat(d[1])+parseFloat(c)),n){if(latepoint_is_period_inside_another(e,t,i,r))return!0}else if(latepoint_is_period_overlapping(e,t,i,r))return!0}return!1}function latepoint_is_period_overlapping(e,t,a,o){return e<o&&a<t}function latepoint_is_period_inside_another(e,t,a,o){return e>=a&&t<=o}function latepoint_minutes_to_hours_preferably(e){var t=latepoint_is_army_clock(),a=Math.floor(e/60);!t&&a>12&&(a-=12);var o=e%60;return o>0&&(a=a+":"+o),a}function latepoint_minutes_to_hours(e){var t=latepoint_is_army_clock(),a=Math.floor(e/60);return!t&&a>12&&(a-=12),a}function latepoint_am_or_pm(e){return latepoint_is_army_clock()?"":e<720?"am":"pm"}function latepoint_hours_and_minutes_to_minutes(e,t){var a=e.split(":"),o=a[0],n=a[1];return"pm"==t&&o<12&&(o=parseInt(o)+12),"am"==t&&12==o&&(o=0),n=parseInt(n)+60*o}function latepoint_get_time_system(){return latepoint_helper.time_system}function latepoint_is_army_clock(){return"24"==latepoint_get_time_system()}function latepoint_minutes_to_hours_and_minutes(e,t){var a=latepoint_is_army_clock(),o=arguments.length>1&&void 0!==t?t:"%02d:%02d",n=Math.floor(e/60);!a&&n>12&&(n-=12);var s=e%60;return sprintf(o,n,s)}function latepoint_generate_form_message_html(e,t){var a='<div class="os-form-message-w status-'+t+'"><ul>';return Array.isArray(e)?e.forEach((function(e){a+="<li>"+e+"</li>"})):a+="<li>"+e+"</li>",a+="</ul></div>"}function latepoint_clear_form_messages(e){e.find(".os-form-message-w").remove()}function latepoint_show_data_in_lightbox(e,t){var a=arguments.length>1&&void 0!==t?t:"";jQuery(".latepoint-lightbox-w").remove();var o="latepoint-lightbox-w latepoint-w ";a&&(o+=a),jQuery("body").append('<div class="'+o+'"><div class="latepoint-lightbox-i">'+e+'<a href="#" class="latepoint-lightbox-close"><i class="latepoint-icon latepoint-icon-x"></i></a></div><div class="latepoint-lightbox-shadow"></div></div>'),jQuery("body").addClass("latepoint-lightbox-active")}function latepoint_add_notification(e,t){var a=arguments.length>1&&void 0!==t?t:"success",o=jQuery("body").find(".os-notifications");o.length||(jQuery("body").append('<div class="os-notifications"></div>'),o=jQuery("body").find(".os-notifications")),o.find(".item").length>0&&o.find(".item:first-child").remove(),o.append('<div class="item item-type-'+a+'">'+e+'<span class="os-notification-close"><i class="latepoint-icon latepoint-icon-x"></i></span></div>')}function latepoint_mask_timefield(e){jQuery().inputmask&&e.inputmask({mask:"99:99",placeholder:"HH:MM"})}function latepoint_mask_phone(e){latepoint_is_phone_masking_enabled()&&jQuery().inputmask&&e.inputmask(latepoint_get_phone_format())}function latepoint_get_phone_format(){return latepoint_helper.phone_format}function latepoint_is_phone_masking_enabled(){return"yes"==latepoint_helper.enable_phone_masking}function latepoint_show_booking_end_time(){return"yes"==latepoint_helper.show_booking_end_time}function latepoint_init_form_masks(){latepoint_is_phone_masking_enabled()&&latepoint_mask_phone(jQuery(".os-mask-phone"))}function latepoint_get_paypal_payment_amount(e){var t,a;return"deposit"==e.find('input[name="booking[payment_portion]"]').val()?e.find(".lp-paypal-btn-trigger").data("deposit-amount"):e.find(".lp-paypal-btn-trigger").data("full-amount")}function latepoint_load_addons_info(){var e=jQuery(".addons-info-holder");e.addClass("os-loading");var t,a={action:"latepoint_route_call",route_name:e.data("route"),params:"",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:function t(a){e.removeClass("os-loading"),"success"===a.status?a.message?e.html(a.message):e.html("Something is wrong. Try refreshing the page."):alert(a.message,"error")}})}function latepoint_check_for_updates(){if(jQuery(".version-log-w").length){var e=jQuery(".version-log-w");e.addClass("os-loading");var t,a={action:"latepoint_route_call",route_name:t=e.data("route"),params:"",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:function t(a){e.removeClass("os-loading"),"success"===a.status?e.html(a.message):alert(a.message,"error")}})}if(jQuery(".version-status-info").length){var o=jQuery(".version-status-info");o.addClass("os-loading");var t,a={action:"latepoint_route_call",route_name:t=o.data("route"),params:"",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:function e(t){o.removeClass("os-loading"),"success"===t.status?o.html(t.message):alert(t.message,"error")}})}jQuery(".addons-info-holder").length&&latepoint_load_addons_info()}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function latepoint_init_side_menu(){jQuery(".menu-toggler").on("click",(function(){var e="full";jQuery(".latepoint-side-menu-w").hasClass("side-menu-full")?(e="compact",jQuery(".latepoint-side-menu-w").addClass("side-menu-compact").removeClass("side-menu-full")):jQuery(".latepoint-side-menu-w").addClass("side-menu-full").removeClass("side-menu-compact");var t,a={action:"latepoint_route_call",route_name:jQuery(this).data("route"),params:{menu_layout_style:e},layout:"none",return_format:"json"};return jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:function e(t){}}),!1}))}function latepoint_init_grouped_bookings_form(){}function latepoint_quick_booking_customer_selected(){jQuery(".customer-info-w").removeClass("selecting").addClass("selected")}function latepoint_custom_day_removed(e){e.closest(".custom-day-work-period").fadeOut(300,(function(){jQuery(this).remove()}))}function latepoint_booking_synced(e){e.closest(".os-booking-tiny-box").removeClass("not-synced").addClass("is-synced"),latepoint_sync_update_progress(!1)}function latepoint_gcal_event_deleted(e){e.closest(".os-booking-tiny-box").remove()}function latepoint_booking_unsynced(e){e.closest(".os-booking-tiny-box").addClass("not-synced").removeClass("is-synced"),latepoint_sync_update_progress(!0)}function latepoint_count_active_connections(e){var t=e.find(".connection-children-list li.active").length,a=e.find(".connection-children-list li").length;t==a?(t=jQuery(".selected-connections").data("all-text"),jQuery(".selected-connections").removeClass("not-all-selected")):(t=t+"/"+a,jQuery(".selected-connections").addClass("not-all-selected"),e.closest(".white-box").find(".os-select-all-toggler").prop("checked",!1)),e.find(".selected-connections strong").text(t)}function latepoint_custom_field_removed(e){e.closest(".os-custom-field-form").remove()}function latepoint_coupon_removed(e){e.closest(".os-coupon-form").remove()}function latepoint_reminder_removed(e){e.closest(".os-reminder-form").remove()}function latepoint_init_custom_fields_form(){jQuery(".latepoint-content-w").on("click",".os-custom-field-form-info",(function(){return jQuery(this).closest(".os-custom-field-form").toggleClass("os-is-editing"),!1})),jQuery(".latepoint-content-w").on("change","select.os-custom-field-type-select",(function(){"select"==jQuery(this).val()?jQuery(this).closest(".os-custom-field-form").find(".os-custom-field-select-values").show():jQuery(this).closest(".os-custom-field-form").find(".os-custom-field-select-values").hide()})),jQuery(".latepoint-content-w").on("keyup",".os-custom-field-name-input",(function(){jQuery(this).closest(".os-custom-field-form").find(".os-custom-field-name").text(jQuery(this).val())}))}function latepoint_init_coupons_form(){jQuery(".latepoint-content-w").on("click",".os-coupon-form-info",(function(){return jQuery(this).closest(".os-coupon-form").toggleClass("os-is-editing"),!1})),jQuery(".latepoint-content-w").on("change","select.os-coupon-medium-select",(function(){"email"==jQuery(this).val()?jQuery(this).closest(".os-coupon-form").find(".os-coupon-email-subject").show():jQuery(this).closest(".os-coupon-form").find(".os-coupon-email-subject").hide()})),jQuery(".latepoint-content-w").on("keyup",".os-coupon-name-input",(function(){jQuery(this).closest(".os-coupon-form").find(".os-coupon-name").text(jQuery(this).val())})),jQuery(".latepoint-content-w").on("keyup",".os-coupon-code-input",(function(){jQuery(this).closest(".os-coupon-form").find(".os-coupon-code").text(jQuery(this).val())}))}function latepoint_init_reminders_form(){jQuery(".latepoint-content-w").on("click",".os-reminder-form-info",(function(){return jQuery(this).closest(".os-reminder-form").toggleClass("os-is-editing"),!1})),jQuery(".latepoint-content-w").on("change","select.os-reminder-medium-select",(function(){"email"==jQuery(this).val()?jQuery(this).closest(".os-reminder-form").find(".os-reminder-email-subject").show():jQuery(this).closest(".os-reminder-form").find(".os-reminder-email-subject").hide()})),jQuery(".latepoint-content-w").on("keyup",".os-reminder-name-input",(function(){jQuery(this).closest(".os-reminder-form").find(".os-reminder-name").text(jQuery(this).val())}))}function latepoint_custom_field_saved(e){}function latepoint_init_custom_day_schedule(){jQuery(".period-type-selector").on("change",(function(){jQuery(this).closest(".custom-day-calendar").attr("data-period-type",jQuery(this).val()),jQuery(".custom-day-calendar").attr("data-picking","start").data("picking","start"),"range"==jQuery(this).val()?(jQuery(".custom-day-calendar-head .calendar-heading").text(jQuery(".custom-day-calendar-head .calendar-heading").data("label-start")),jQuery(".custom-day-calendar #start_custom_date").focus()):(jQuery(".custom-day-calendar .os-day.selected").removeClass("selected"),jQuery(".latepoint-lightbox-footer").hide(),jQuery(".custom-day-calendar-head .calendar-heading").text(jQuery(".custom-day-calendar-head .calendar-heading").data("label-single")))})),jQuery("#custom_day_calendar_month, #custom_day_calendar_year").on("change",(function(){var e=jQuery(".custom-day-calendar-month"),t=e.data("route");e.addClass("os-loading");var a,o={action:"latepoint_route_call",route_name:t,params:{target_date_string:jQuery("#custom_day_calendar_year").val()+"-"+jQuery("#custom_day_calendar_month").val()+"-01"},layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function t(a){e.removeClass("os-loading"),"success"===a.status&&e.html(a.message)}})})),jQuery(".custom-day-calendar").on("focus","#start_custom_date",(function(){jQuery(".custom-day-calendar-head .calendar-heading").text(jQuery(".custom-day-calendar-head .calendar-heading").data("label-start")),jQuery(".custom-day-calendar").attr("data-picking","start").data("picking","start")})),jQuery(".custom-day-calendar").on("focus","#end_custom_date",(function(){jQuery(".custom-day-calendar-head .calendar-heading").text(jQuery(".custom-day-calendar-head .calendar-heading").data("label-end")),jQuery(".custom-day-calendar").attr("data-picking","end").data("picking","end")})),jQuery(".custom-day-calendar").on("click",".os-day",(function(){var e=jQuery(this);if(e.closest(".custom-day-calendar").find(".os-day.selected").removeClass("selected"),e.addClass("selected"),"start"==jQuery(".custom-day-calendar").data("picking")){if(jQuery(".custom-day-settings-w #start_custom_date").val(e.data("date")).trigger("keyup"),"range"==jQuery(".period-type-selector").val()&&(jQuery(".custom-day-calendar #end_custom_date").focus(),!jQuery(".custom-day-calendar #end_custom_date").val()))return!1}else jQuery(".custom-day-settings-w #end_custom_date").val(e.data("date")).trigger("keyup");return jQuery(".latepoint-lightbox-footer").slideDown(200),"yes"==jQuery(".custom-day-calendar").data("show-schedule")&&jQuery(".latepoint-lightbox-w").removeClass("hide-schedule"),!1}))}function latepoint_init_updates_page(){}function latepoint_init_monthly_calendar_navigation(){jQuery(".calendar-location-selector").on("change",(function(){latepoint_reload_daily_agents_page()})),jQuery(".os-month-next-btn").on("click",(function(){if(jQuery(".os-monthly-calendar-days-w.active + .os-monthly-calendar-days-w").length)jQuery(".os-monthly-calendar-days-w.active").removeClass("active").next(".os-monthly-calendar-days-w").addClass("active"),latepoint_calendar_set_month_label();else{var e=jQuery(this);e.addClass("os-loading");var t=jQuery(this).data("route"),a=jQuery(".os-monthly-calendar-days-w.active"),o=a.data("calendar-layout"),n=a.data("calendar-year"),s=a.data("calendar-month");12==s?(n+=1,s=1):s+=1;var i,r,l={target_date_string:n+"-"+s+"-1",agent_id:jQuery(".agent-select").val(),service_id:jQuery(".service-select").val(),allow_full_access:!0,calendar_layout:o};jQuery(".cc-location-selector select").length&&jQuery(".cc-location-selector select").val()&&(l.location_id=jQuery(".cc-location-selector select").val());var c={action:"latepoint_route_call",route_name:t,params:l,layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:c,success:function t(a){e.removeClass("os-loading"),"success"===a.status&&(jQuery(".os-months").append(a.message),jQuery(".os-monthly-calendar-days-w.active").removeClass("active").next(".os-monthly-calendar-days-w").addClass("active"),latepoint_calendar_set_month_label())}})}return!1})),jQuery(".os-month-today-btn").on("click",(function(){return jQuery(this).addClass("os-loading"),latepoint_reload_daily_agents_page(jQuery(this).data("date")),!1})),jQuery(".os-month-prev-btn").on("click",(function(){if(jQuery(".os-monthly-calendar-days-w.active").prev(".os-monthly-calendar-days-w").length)jQuery(".os-monthly-calendar-days-w.active").removeClass("active").prev(".os-monthly-calendar-days-w").addClass("active"),latepoint_calendar_set_month_label();else{var e=jQuery(this);e.addClass("os-loading");var t=jQuery(this).data("route"),a=jQuery(".os-monthly-calendar-days-w.active").last(),o=a.data("calendar-layout"),n=a.data("calendar-year"),s=a.data("calendar-month");1==s?(n-=1,s=12):s-=1;var i,r,l={target_date_string:n+"-"+s+"-1",agent_id:jQuery(".agent-select").val(),service_id:jQuery(".service-select").val(),allow_full_access:!0,calendar_layout:o};jQuery(".cc-location-selector select").length&&jQuery(".cc-location-selector select").val()&&(l.location_id=jQuery(".cc-location-selector select").val());var c={action:"latepoint_route_call",route_name:t,params:l,layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:c,success:function t(a){e.removeClass("os-loading"),"success"===a.status&&(jQuery(".os-months").prepend(a.message),jQuery(".os-monthly-calendar-days-w.active").removeClass("active").prev(".os-monthly-calendar-days-w").addClass("active"),latepoint_calendar_set_month_label())}})}return!1}))}function latepoint_calendar_set_month_label(){jQuery(".os-current-month-label .current-month").text(jQuery(".os-monthly-calendar-days-w.active").data("calendar-month-label")),jQuery(".os-current-month-label .current-year").text(jQuery(".os-monthly-calendar-days-w.active").data("calendar-year"))}function latepoint_init_element_togglers(){jQuery("[data-toggle-element]").on("click",(function(){var e=jQuery(this);e.closest(".os-form-checkbox-group").toggleClass("is-checked"),jQuery(e.data("toggle-element")).toggle()}))}function latepoint_init_color_picker(){jQuery(".latepoint-color-picker").length&&jQuery(".latepoint-color-picker").each((function(){var e=jQuery(this).data("color"),t=jQuery(this)[0],a=jQuery(this).closest(".latepoint-color-picker-w");Pickr.create({el:t,default:e,comparison:!1,useAsButton:!0,components:{preview:!0,opacity:!1,hue:!0,interaction:{input:!1,clear:!1,save:!0}},onChange:function e(t,o){a.find(".os-form-control").val(t.toHEX().toString())}})}))}function latepoint_lightbox_close(){jQuery("body").removeClass("latepoint-lightbox-active"),jQuery(".latepoint-lightbox-w").remove()}function latepoint_reload_select_service_categories(){jQuery(".service-selector-adder-field-w").each((function(){var e=jQuery(this),t,a={action:"latepoint_route_call",route_name:jQuery(".service-selector-adder-field-w").find("select").data("select-source"),params:"",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:function t(a){e.removeClass("os-loading"),"success"===a.status?(latepoint_lightbox_close(),e.find("select").html(a.message),e.find("select option:last").attr("selected","selected")):alert(a.message,"error")}})}))}function latepoint_wizard_item_editing_cancelled(){jQuery(".os-wizard-setup-w").removeClass("is-sub-editing"),jQuery(".os-wizard-footer").show(),jQuery(".os-wizard-footer .os-wizard-next-btn").show()}function latepoint_load_quick_availability(e,t,a,o,n){var s=arguments.length>1&&void 0!==t&&t,i=arguments.length>2&&void 0!==a&&a,r=arguments.length>3&&void 0!==o&&o,l=arguments.length>4&&void 0!==n&&n;e.addClass("os-loading");var c=jQuery(".trigger-quick-availability").data("route"),d=jQuery(".quick-booking-form-w");s&&d.find('select[name="booking[agent_id]"]').val(s),d.find('input[name="booking[service_id]"]').val()||d.find(".os-services-select-field-w .service-option:first").click();var u=d.find("form").serialize();i&&(u+="&start_date="+i),(r||l)&&(u+="&show_days_only=true"),l&&(u+="&previous_days=true");var p={action:"latepoint_route_call",route_name:c,params:u,return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:p,success:function t(a){e.removeClass("os-loading"),"success"===a.status?r?(e.parent(".os-availability-next-w").remove(),jQuery(".latepoint-side-panel-w .os-availability-days").append(a.message)):l?(e.parent(".os-availability-prev-w").remove(),jQuery(".latepoint-side-panel-w .os-availability-days").prepend(a.message),jQuery(".latepoint-side-panel-w .os-availability-days").scrollTop(30)):(jQuery(".latepoint-side-panel-w .side-sub-panel").length?jQuery(".latepoint-side-panel-w .side-sub-panel").replaceWith(a.message):jQuery(".latepoint-side-panel-w").append(a.message),jQuery(".latepoint-side-panel-w .os-availability-days").scrollTop(30),latepoint_init_quick_availability_form()):alert(a.message,"error")}})}function latepoint_init_quick_availability_form(){var e=jQuery(".quick-booking-form-w input#booking_start_date").val(),t,a,o=latepoint_hours_and_minutes_to_minutes(jQuery('.quick-booking-form-w input[name="booking[start_time][formatted_value]"]').val(),jQuery('.quick-booking-form-w input[name="booking[start_time][ampm]"]').val());jQuery(".quick-availability-per-day-w .os-availability-days").find('.agent-timeslot[data-formatted-date="'+e+'"][data-minutes="'+o+'"]').addClass("selected"),jQuery(".quick-availability-per-day-w").on("click",".load-more-quick-availability",(function(){return latepoint_load_quick_availability(jQuery(this),!1,jQuery(this).data("start-date"),!0),!1})),jQuery(".quick-availability-per-day-w").on("click",".load-prev-quick-availability",(function(){return latepoint_load_quick_availability(jQuery(this),!1,jQuery(this).data("start-date"),!1,!0),!1})),jQuery('.quick-availability-per-day-w select[name="booking[agent_id]"]').on("change",(function(){latepoint_load_quick_availability(jQuery(".trigger-quick-availability"),jQuery(this).val())})),jQuery(".os-time-group label").on("click",(function(){jQuery(this).closest(".os-time-group").find(".os-form-control").focus()})),jQuery(".quick-availability-per-day-w").on("click",".fill-booking-time",(function(){jQuery(".os-availability-days .agent-timeslot.selected").removeClass("selected"),jQuery(this).addClass("selected");var e=jQuery(this).data("date"),t=jQuery(this).data("formatted-date"),a=jQuery(this).data("minutes"),o=jQuery(".os-services-select-field-w .service-option-selected").data("duration"),n=jQuery(".quick-booking-form-w");n.find('input[name="booking[start_date]"]').val(t);var s=a,i=latepoint_minutes_to_hours_and_minutes(s);s>=720?n.find(".quick-start-time-w .time-pm").click():n.find(".quick-start-time-w .time-am").click(),n.find('input[name="booking[start_time][formatted_value]"]').val(i),latepoint_set_booking_end_time(),n.find(".ws-period").addClass("animate-filled-in"),setTimeout((function(){n.find(".ws-period").removeClass("animate-filled-in")}),500)}))}function latepoint_init_work_period_form(){latepoint_mask_timefield(jQuery(".os-time-input-w .os-mask-time"))}function latepoint_close_side_panel(){jQuery(".latepoint-side-panel-w").remove()}function latepoint_reload_after_booking_save(){jQuery(".bookings-daily-agents .os-day-current.selected").first().click(),jQuery(".calendar-week-agent-w").length&&latepoint_load_calendar(jQuery(".calendar-start-date").val(),jQuery(".calendar-agent-selector").val(),jQuery(".calendar-location-selector").val()),jQuery(".os-widget").each((function(){latepoint_reload_widget(jQuery(this))})),jQuery("table.os-reload-on-booking-update").length&&latepoint_filter_table(jQuery("table.os-reload-on-booking-update"),jQuery("table.os-reload-on-booking-update")),latepoint_close_side_panel()}function latepoint_init_quick_booking_form(){latepoint_lightbox_close(),jQuery(".os-late-select").lateSelect(),jQuery(".save-transaction-btn").on("click",(function(){var e=jQuery(this),t=e.closest(".quick-add-transaction-box-w"),a={amount:t.find('input[name="transaction[amount]"]').val(),date:t.find('input[name="transaction[created_at]"]').val(),token:t.find('input[name="transaction[token]"]').val(),processor:t.find('select[name="transaction[processor]"]').val(),payment_method:t.find('select[name="transaction[payment_method]"]').val(),booking_id:jQuery(".quick-booking-form-w").find('input[name="booking[id]"]').val(),customer_id:jQuery(".quick-booking-form-w").find('input[name="booking[customer_id]"]').val()},o={action:"latepoint_route_call",route_name:t.data("route"),params:a,return_format:"json"};return e.addClass("os-loading"),jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function a(o){e.removeClass("os-loading"),"success"===o.status?(jQuery(".quick-transactions-list-w").append(o.message),t.hide(),jQuery(".trigger-add-transaction-btn").show()):alert(o.message)}}),!1})),jQuery(".trigger-price-recalculate").on("click",(function(){return latepoint_recalculate_booking_price(jQuery(this)),!1})),jQuery(".trigger-add-transaction-btn").on("click",(function(){return jQuery(".quick-add-transaction-box-w").show().find('input[name="transaction[amount]"]').focus(),jQuery(".trigger-add-transaction-btn").hide(),!1})),jQuery(".trigger-cancel-add-transaction-btn").on("click",(function(){return jQuery(".quick-add-transaction-box-w").hide(),jQuery(".trigger-add-transaction-btn").show(),!1})),jQuery(".trigger-quick-availability").on("click",(function(){return latepoint_load_quick_availability(jQuery(".open-quick-availability-btn")),!1})),jQuery('.quick-booking-form-w input[name="booking[start_time][formatted_value]"]').on("change",(function(){latepoint_set_booking_end_time()})),latepoint_mask_timefield(jQuery(".latepoint-side-panel-w .os-mask-time")),latepoint_mask_phone(jQuery(".latepoint-side-panel-w .os-mask-phone")),jQuery(".customers-selector-search-input").keyup((function(){var e=jQuery(this),t=e.val().toLowerCase();t!=e.data("current-query")&&(e.closest(".customers-selector-search-w").addClass("os-loading"),e.data("searching-query",t),setTimeout((function(){if(t==jQuery(".customers-selector-search-input").data("searching-query")){var a={action:"latepoint_route_call",route_name:e.data("route"),params:{query:t},return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:function a(o){e.data("searching-query")==t&&(e.closest(".customers-selector-search-w").removeClass("os-loading"),"success"===o.status?(e.data("current-query",t),jQuery(".quick-booking-form-w .customers-options-list").html(o.message)):console.log(o.message))}})}}),300,t,e))})),jQuery(".latepoint-side-panel-w").on("change",".agent-selector",(function(){latepoint_apply_agent_selector_change()})),jQuery(".latepoint-side-panel-w").on("change",'select[name="booking[location_id]"]',(function(){latepoint_apply_agent_selector_change()})),jQuery(".latepoint-side-panel-w").on("change",'select[name="booking[total_attendies]"]',(function(){latepoint_apply_agent_selector_change()})),jQuery(".latepoint-side-panel-w").on("change",".os-affects-duration",(function(){latepoint_set_booking_end_time(),jQuery(".quick-availability-per-day-w").length&&latepoint_load_quick_availability(jQuery(".trigger-quick-availability"))})),jQuery(".latepoint-side-panel-w").on("click",".services-options-list .service-option",(function(){var e=jQuery(this).html(),t;return jQuery(this).closest(".os-services-select-field-w").find(".service-option-selected").html(e).data("id",jQuery(this).data("id")).data("duration",jQuery(this).data("duration")).data("buffer-before",jQuery(this).data("buffer-before")).data("buffer-after",jQuery(this).data("buffer-after")).data("capacity-min",jQuery(this).data("capacity-min")).data("capacity-max",jQuery(this).data("capacity-max")).data("extra-durations",jQuery(this).data("extra-durations")),jQuery(this).closest(".os-services-select-field-w").find(".service-option.selected").removeClass("selected"),jQuery(this).addClass("selected").closest(".os-services-select-field-w").removeClass("active"),latepoint_apply_service_selector_change(),!1}))}function latepoint_reload_widget(e){var t=e.find("select, input").serialize(),a={action:"latepoint_route_call",route_name:e.data("os-reload-action"),params:t,return_format:"json"};e.addClass("os-loading"),jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:function t(a){if(e.removeClass("os-loading"),"success"===a.status){var o=jQuery(a.message);o.removeClass("os-widget-animated"),e=e.replaceWith(o),latepoint_init_daterangepicker(o.find(".os-date-range-picker")),e.hasClass("os-widget-top-agents")&&latepoint_init_circles_charts(),e.hasClass("os-widget-daily-bookings")&&(latepoint_init_daily_bookings_chart(),latepoint_init_donut_charts())}else alert(a.message)}})}function latepoint_load_calendar(e,t,a){var o=arguments.length>2&&void 0!==a&&a,n=jQuery(".calendar-week-agent-w").data("calendar-action");jQuery(".calendar-week-agent-w").addClass("os-loading");var s={target_date:e,agent_id:t};o&&(s.location_id=o);var i={action:"latepoint_route_call",route_name:n,params:jQuery.param(s),return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:i,success:function e(t){"success"===t.status?(jQuery(".calendar-week-agent-w").html(t.message).removeClass("os-loading"),jQuery(".calendar-load-target-date.os-loading").removeClass("os-loading")):alert(t.message)}})}function latepoint_recalculate_booking_price(e){e.addClass("os-loading");var t=e.closest("form.booking-quick-edit-form"),a=t.serialize(),o,n={action:"latepoint_route_call",route_name:e.data("route"),params:a,return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:n,success:function a(o){e.removeClass("os-loading"),"success"===o.status?(t.find('input[name="booking[price]"]').val(o.message),t.find('input[name="booking[coupon_discount]"]').length&&t.find('input[name="booking[coupon_discount]"]').val(o.coupon_discount)):alert(o.message)}})}function latepoint_complex_selector_select(e){e.each((function(){jQuery(this).addClass("active"),jQuery(this).find(".connection-children-list li").addClass("active"),jQuery(this).find(".connection-child-is-connected").val("yes"),latepoint_count_active_connections(jQuery(this))}))}function latepoint_complex_selector_deselect(e){e.each((function(){jQuery(this).removeClass("active"),jQuery(this).removeClass("show-customize-box"),jQuery(this).find(".connection-children-list li.active").removeClass("active"),jQuery(this).find(".connection-child-is-connected").val("no"),latepoint_count_active_connections(jQuery(this))}))}function latepoint_apply_agent_selector_change(){jQuery(".quick-availability-per-day-w").length&&latepoint_load_quick_availability(jQuery(".trigger-quick-availability"))}function latepoint_set_booking_end_time(){var e=jQuery("form.booking-quick-edit-form"),t=0,a=e.find(".os-service-durations select").val();t+=a,e.find('select[name="temp_service_extras_ids"] option:selected').length&&e.find('select[name="temp_service_extras_ids"] option:selected').each((function(){var e=Number(jQuery(this).data("duration")),a=jQuery(this).closest(".lateselect-w").find('.ls-item[data-value="'+jQuery(this).val()+'"]').find(".os-late-quantity-selector-input");a.length&&(e=Number(e)*Number(a.val())),t=Number(t)+Number(e)}));var o=e.find('input[name="booking[start_time][formatted_value]"]').val();if(o){var n,s=latepoint_hours_and_minutes_to_minutes(o,e.find('input[name="booking[start_time][ampm]"]').val()),i=parseInt(s)+parseInt(t),r=i>=720?"pm":"am",l=latepoint_minutes_to_hours_and_minutes(i);e.find('input[name="booking[end_time][formatted_value]"]').val(l),e.find(".quick-end-time-w .time-ampm-select.time-"+r).click(),e.find('input[name="booking[end_time][formatted_value]"]').closest(".os-form-group").addClass("has-value")}}function latepoint_apply_service_selector_change(){var e=jQuery(".os-services-select-field-w .service-option-selected"),t=e.data("id"),a=e.data("buffer-before"),o=e.data("buffer-after"),n=e.data("duration"),s=e.data("capacity-min"),i=e.data("capacity-max"),r=e.data("extra-durations"),l=jQuery("form.booking-quick-edit-form");l.find('input[name="booking[buffer_before]"]').val(a).closest(".os-form-group").addClass("has-value"),l.find('input[name="booking[buffer_after]"]').val(o).closest(".os-form-group").addClass("has-value"),l.find('input[name="booking[service_id]"]').val(t).closest(".os-form-group").addClass("has-value");var c='<option value="'+n+'">'+n+" "+latepoint_helper.string_minutes+"</option>";r.length?(jQuery.each(r,(function(e,t){c+='<option value="'+t.duration+'">'+t.duration+" "+latepoint_helper.string_minutes+"</option>"})),l.find(".os-service-durations").show()):l.find(".os-service-durations").hide(),jQuery(".booking-total-attendies-selector-w .capacity-info strong").text(i);for(var d="",u=1;u<=i;u++)d+='<option value="'+u+'">'+u+"</option>";var p=Math.min(jQuery(".booking-total-attendies-selector-w select").val(),i);jQuery(".booking-total-attendies-selector-w select").html(d).val(p),i>1?jQuery(".booking-total-attendies-selector-w").show():jQuery(".booking-total-attendies-selector-w").hide(),l.find(".os-service-durations select").html(c),latepoint_set_booking_end_time(),jQuery(".quick-availability-per-day-w").length&&latepoint_load_quick_availability(jQuery(".trigger-quick-availability"))}function latepoint_init_daily_bookings_chart(){if("undefined"!=typeof Chart&&jQuery("#chartDailyBookings").length){var e,t=jQuery("#chartDailyBookings"),a=t.data("chart-labels").toString().split(","),o=t.data("chart-values").toString().split(",").map(Number),n=Math.max.apply(Math,o)+5,s=latepoint_helper.font_family;Chart.defaults.global.defaultFontFamily=s,Chart.defaults.global.defaultFontSize=18,Chart.defaults.global.defaultFontStyle="400",Chart.defaults.global.tooltips.titleFontFamily=s,Chart.defaults.global.tooltips.titleFontSize=14,Chart.defaults.global.tooltips.titleFontColor="rgba(255,255,255,0.6)",Chart.defaults.global.tooltips.backgroundColor="#000",Chart.defaults.global.tooltips.titleFontStyle="400",Chart.defaults.global.tooltips.titleMarginBottom=1,Chart.defaults.global.tooltips.bodyFontFamily=s,
Chart.defaults.global.tooltips.bodyFontSize=24,Chart.defaults.global.tooltips.bodyFontStyle="500",Chart.defaults.global.tooltips.displayColors=!1,Chart.defaults.global.tooltips.xPadding=10,Chart.defaults.global.tooltips.yPadding=8,Chart.defaults.global.tooltips.yAlign="bottom",Chart.defaults.global.tooltips.xAlign="center",Chart.defaults.global.tooltips.cornerRadius=0,Chart.defaults.global.tooltips.intersect=!1;var i=t[0].getContext("2d"),r=i.createLinearGradient(500,0,100,0);r.addColorStop(0,"#587ef8"),r.addColorStop(1,"#1e4fef");var l=i.createLinearGradient(0,200,0,50);l.addColorStop(0,"rgba(163, 165, 243, 0)"),l.addColorStop(1,"rgba(163, 165, 243, 0.1)");var c={labels:a,datasets:[(e={label:"",fill:!0,lineTension:.3,backgroundColor:l,borderColor:"#0937ff",borderWidth:2,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"#fbfcff"},_defineProperty(e,"borderColor",r),_defineProperty(e,"pointBackgroundColor","#0937ff"),_defineProperty(e,"pointRadius",0),_defineProperty(e,"pointBorderWidth",2),_defineProperty(e,"pointHoverRadius",5),_defineProperty(e,"pointHoverBorderWidth",2),_defineProperty(e,"pointHoverBackgroundColor","#0937ff"),_defineProperty(e,"pointHoverBorderColor","#fff"),_defineProperty(e,"pointHitRadius",15),_defineProperty(e,"data",o),_defineProperty(e,"spanGaps",!1),e)]},d=new Chart(t,{type:"line",data:c,options:{layout:{padding:{top:20,left:20,right:20,bottom:20}},responsive:!0,maintainAspectRatio:!1,legend:{display:!1},scales:{xAxes:[{display:!1,ticks:{fontSize:"10",fontColor:"#8894AF"},gridLines:{color:"rgba(0,0,0,0)",zeroLineColor:"rgba(0,0,0,0)"}}],yAxes:[{gridLines:{color:"rgba(0,0,0,0.0)",zeroLineColor:"rgba(0,0,0,0.0)"},display:!1,ticks:{beginAtZero:!1,suggestedMax:n,fontSize:"10",fontColor:"#8894AF"}}]}}})}}function latepoint_reload_daily_agents_page(e){var t=arguments.length>0&&void 0!==e&&e;jQuery(".bookings-daily-agents").addClass("os-loading");var a=jQuery(".agent-select").val(),o=jQuery(".service-select").val();t=t||jQuery(".daily-agent-monthly-calendar-w .os-day.selected").data("date");var n=jQuery(".bookings-daily-agents").data("route"),s={target_date:t};a&&(s.selected_agent_id=a),o&&(s.selected_service_id=o),jQuery(".cc-location-selector select").length&&jQuery(".cc-location-selector select").val()&&(s.location_id=jQuery(".cc-location-selector select").val());var i={action:"latepoint_route_call",route_name:n,params:jQuery.param(s),layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:i,success:function e(t){"success"===t.status&&(jQuery(".bookings-daily-agents").replaceWith(t.message),latepoint_init_donut_charts(),latepoint_init_daily_agent_calendar(),latepoint_init_monthly_calendar_navigation()),jQuery(".bookings-daily-agents").removeClass("os-loading")}})}function latepoint_init_daily_agent_calendar(){jQuery("select.agent-select, select.service-select").on("change",(function(){latepoint_reload_daily_agents_page()})),jQuery(".daily-agent-monthly-calendar-w").on("click",".os-day",(function(){var e=jQuery(this).closest(".daily-agent-monthly-calendar-w");jQuery(".daily-agent-monthly-calendar-w .os-day.selected").removeClass("selected"),jQuery(this).addClass("selected"),e.hasClass("horizontal-calendar")&&e.find(".current-month").text(jQuery(this).data("nice-date")),latepoint_reload_daily_agents_page()}))}function latepoint_init_donut_charts(){if("undefined"!=typeof Chart&&jQuery(".os-donut-chart").length){var e=latepoint_helper.font_family;Chart.defaults.global.defaultFontFamily=e,Chart.defaults.global.defaultFontSize=18,Chart.defaults.global.defaultFontStyle="400",Chart.defaults.global.tooltips.titleFontFamily=e,Chart.defaults.global.tooltips.titleFontSize=14,Chart.defaults.global.tooltips.titleFontColor="rgba(255,255,255,0.6)",Chart.defaults.global.tooltips.backgroundColor="#000",Chart.defaults.global.tooltips.titleFontStyle="400",Chart.defaults.global.tooltips.titleMarginBottom=1,Chart.defaults.global.tooltips.bodyFontFamily=e,Chart.defaults.global.tooltips.bodyFontSize=24,Chart.defaults.global.tooltips.bodyFontStyle="500",Chart.defaults.global.tooltips.displayColors=!1,Chart.defaults.global.tooltips.xPadding=10,Chart.defaults.global.tooltips.yPadding=8,Chart.defaults.global.tooltips.yAlign="bottom",Chart.defaults.global.tooltips.xAlign="center",Chart.defaults.global.tooltips.cornerRadius=0,Chart.defaults.global.tooltips.intersect=!1,jQuery(".os-donut-chart").each((function(e){var t=jQuery(this).data("chart-colors").toString().split(","),a=jQuery(this).data("chart-labels").toString().split(","),o=jQuery(this).data("chart-values").toString().split(",").map(Number),n=jQuery(this),s=new Chart(n,{type:"doughnut",data:{labels:a,datasets:[{data:o,backgroundColor:t,hoverBackgroundColor:t,borderWidth:0,hoverBorderColor:"transparent"}]},options:{layout:{padding:{top:40}},tooltips:{callbacks:{title:function e(t,a){return a.labels[t[0].index]},label:function e(t,a){return a.datasets[0].data[t.index]}}},legend:{display:!1},animation:{animateScale:!0},cutoutPercentage:80,responsive:!1,maintainAspectRatio:!0}})}))}}function latepoint_init_circles_charts(){jQuery(".circle-chart").each((function(e){var t=jQuery(this).prop("id"),a=jQuery(this).data("max-value"),o=jQuery(this).data("chart-value"),n=jQuery(this).data("chart-color"),s=jQuery(this).data("chart-color-fade"),i=Circles.create({id:t,radius:25,value:o,maxValue:a,width:2,text:function e(t){return Math.round(t)},colors:[n,s],duration:200,wrpClass:"circles-wrp",textClass:"circles-text",valueStrokeClass:"circles-valueStroke",maxValueStrokeClass:"circles-maxValueStroke",styleWrapper:!0,styleText:!0})}))}function latepoint_random_text(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=a.length,n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*o));return t}function latepoint_get_order_for_service_categories(){}function latepoint_init_daterangepicker(e){e.each((function(){var e=jQuery(this).find('input[name="date_from"], .os-datepicker-date-from').val(),t=jQuery(this).find('input[name="date_to"], .os-datepicker-date-to').val(),a={};jQuery(this).data("can-be-cleared")&&(a={cancelLabel:jQuery(this).data("clear-btn-label")}),moment.locale(latepoint_helper.wp_locale),jQuery(this).daterangepicker({opens:"left",singleDatePicker:"yes"==jQuery(this).data("single-date"),startDate:e?moment(e):moment(),endDate:t?moment(t):moment(),locale:a})})),e.on("cancel.daterangepicker",(function(e,t){t.element.data("can-be-cleared")&&(t.element.find('input[name="date_from"], .os-datepicker-date-from').val(""),t.element.find('input[name="date_to"], .os-datepicker-date-to').val(""),t.element.find("span.range-picker-value").text(t.element.data("no-value-label")),t.element.hasClass("os-table-filter-datepicker")&&latepoint_filter_table(t.element.closest("table"),t.element.closest(".os-form-group")))})),e.on("apply.daterangepicker",(function(e,t){"yes"==t.element.data("single-date")?t.element.find(".range-picker-value").text(t.startDate.format("ll")):t.element.find(".range-picker-value").text(t.startDate.format("ll")+" - "+t.endDate.format("ll")),t.element.find('input[name="date_from"], .os-datepicker-date-from').attr("value",t.startDate.format("YYYY-MM-DD")),t.element.find('input[name="date_to"], .os-datepicker-date-to').attr("value",t.endDate.format("YYYY-MM-DD")),t.element.closest(".os-widget").length&&latepoint_reload_widget(t.element.closest(".os-widget")),t.element.hasClass("os-table-filter-datepicker")&&latepoint_filter_table(t.element.closest("table"),t.element.closest(".os-form-group"))}))}function latepoint_recalculate_items_count_in_category(){jQuery(".os-category-items-count").each((function(){var e=jQuery(this).closest(".os-category-parent-w").find(".item-in-category-w").length;jQuery(this).find("span").text(e)}))}function latepoint_remove_agent_box(e){var t;e.closest(".agent-box-w").fadeOut(300,(function(){jQuery(this).remove()}))}function latepoint_remove_service_box(e){var t;e.closest(".service-box-w").fadeOut(300,(function(){jQuery(this).remove()}))}function latepoint_init_monthly_view(){jQuery(".calendar-month-agents-w").length&&(jQuery(".ma-days-with-bookings-w").length,jQuery("#monthly_calendar_month_select, #monthly_calendar_year_select, #monthly_calendar_location_select").on("change",(function(){var e=jQuery(".calendar-month-agents-w"),t=e.data("route");e.addClass("os-loading");var a={month:jQuery("#monthly_calendar_month_select").val(),year:jQuery("#monthly_calendar_year_select").val()};jQuery("#monthly_calendar_location_select").length&&jQuery("#monthly_calendar_location_select").val()&&(a.location_id=jQuery("#monthly_calendar_location_select").val());var o={action:"latepoint_route_call",route_name:t,params:a,layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function t(a){e.removeClass("os-loading"),"success"===a.status&&e.html(a.message)}})})))}function latepoint_init_copy_on_click_elements(){jQuery(".os-click-to-copy").mouseenter((function(){var e=jQuery(this),t=e.position(),a=jQuery(this).outerWidth(),o=t.left+a+5,n=t.top+3;"left"==e.data("copy-tooltip-position")&&(o=o-a-5,n+=e.outerHeight()),jQuery(this).after('<div class="os-click-to-copy-prompt" style="top: '+n+"px; left: "+o+'px;">'+latepoint_helper.click_to_copy_prompt+"</div>")})).mouseleave((function(){jQuery(this).nextAll(".os-click-to-copy-prompt").remove()})),jQuery(".os-click-to-copy").on("click",(function(){var e=jQuery(this);e.nextAll(".os-click-to-copy-prompt").hide();var t=jQuery("<input>");jQuery("body").append(t);var a=e.is("input")?e.val():e.text();t.val(a).select(),document.execCommand("Copy"),t.remove();var o=e.position(),n=e.outerWidth(),s=o.left+n+5,i=o.top+3,r;"left"==e.data("copy-tooltip-position")&&(s=s-n-5,i+=e.outerHeight()),jQuery('<div class="os-click-to-copy-done" style="top: '+i+"px; left: "+s+'px;">'+latepoint_helper.click_to_copy_done+"</div>").insertAfter(e).animate({opacity:0,left:s+20},600),setTimeout((function(){e.nextAll(".os-click-to-copy-done").remove(),e.nextAll(".os-click-to-copy-prompt").show()}),800)}))}function latepoint_sync_update_progress(e){var t=jQuery(".os-sync-stat-tiles .os-tile-value span").text();t=e?parseInt(t)-1:parseInt(t)+1,jQuery(".os-sync-stat-tiles .os-tile-value span").text(t),jQuery(".os-tile-hor-progress-chart").data("value",t);var a=jQuery(".os-tile-hor-progress-chart").data("total"),o=jQuery(".os-tile-hor-progress-chart").data("value");if(a>0){var n=Math.round(o/a*100);jQuery(".os-tile-hor-progress-chart-value").css("width",n+"%")}}function latepoint_remove_first_synced_booking_with_google(){var e=jQuery(".os-booking-tiny-box.is-synced:first .os-booking-sync-google-trigger");if(!e.length||jQuery(".remove-all-bookings-from-google-trigger").hasClass("stop-removing"))return jQuery(".remove-all-bookings-from-google-trigger").removeClass("os-removing").removeClass("stop-removing").find("span").text(jQuery(".remove-all-bookings-from-google-trigger").data("label-remove")),!1;var t,a,o={action:"latepoint_route_call",route_name:e.data("os-remove-action"),params:e.data("os-params"),layout:"none",return_format:"json"};e.addClass("os-loading"),jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function t(a){"success"===a.status&&(e.closest(".os-booking-tiny-box").removeClass("is-synced").addClass("not-synced"),e.removeClass("os-loading"),latepoint_sync_update_progress(!0),latepoint_remove_first_synced_booking_with_google())}})}function latepoint_sync_next_booking_with_google(){var e=jQuery(".os-booking-tiny-box.not-synced:first .os-booking-sync-google-trigger");if(!e.length||jQuery(".sync-all-bookings-to-google-trigger").hasClass("stop-syncing"))return jQuery(".sync-all-bookings-to-google-trigger").removeClass("os-syncing").removeClass("stop-syncing").find("span").text(jQuery(".sync-all-bookings-to-google-trigger").data("label-sync")),!1;var t,a,o={action:"latepoint_route_call",route_name:e.data("os-action"),params:e.data("os-params"),layout:"none",return_format:"json"};e.addClass("os-loading"),jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function t(a){"success"===a.status&&(e.closest(".os-booking-tiny-box").removeClass("not-synced").addClass("is-synced"),e.removeClass("os-loading"),latepoint_sync_update_progress(!1),latepoint_sync_next_booking_with_google())}})}function latepoint_init_reminder_form(){"undefined"!=typeof tinymce&&jQuery(".os-reminder-form:last-child textarea").length&&tinymce.execCommand("mceAddEditor",!0,jQuery(".os-reminder-form:last-child textarea").attr("id"))}function latepoint_filter_table(e,t,a){var o=!(arguments.length>2&&void 0!==a)||a;t.addClass("os-loading");var n=e.find(".os-table-filter").serialize(),s=e.closest(".table-with-pagination-w");o?s.find("select.pagination-page-select").val(1):n+="&page_number="+s.find("select.pagination-page-select").val();var i=e.data("route"),r={action:"latepoint_route_call",route_name:i,params:n,layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:r,success:function a(n){if(t.removeClass("os-loading"),"success"===n.status){if(e.find("tbody").html(n.message),n.total_pages&&o){for(var i="",r=1;r<=n.total_pages;r++)i+="<option>"+r+"</option>";s.find("select.pagination-page-select").html(i)}s.find(".os-pagination-from").text(n.showing_from),s.find(".os-pagination-to").text(n.showing_to),s.find(".os-pagination-total").text(n.total_records)}}})}!function($){$.fn.lateSelect=function(){function e(e){var t="";return e.data("quantity")&&(t='<span class="os-late-quantity-selector-w"><span class="os-late-quantity-selector minus" data-sign="minus"></span><input class="os-late-quantity-selector-input" type="text" data-max-quantity="'+e.data("max-quantity")+'" value="'+e.data("quantity")+'"/><span class="os-late-quantity-selector plus" data-sign="plus"></span></span>'),'<div class="ls-item" data-value="'+e.val()+'"><span class="latepoint-icon latepoint-icon-x ls-item-remover"></span><span>'+e.text()+"</span>"+t+"</div>"}this.each((function(){var t="",a="",o="",n="";$(this).hide(),$(this).find("option").each((function(){$(this).is(":selected")&&(o+=e($(this))),n=$(this).is(":selected")?"selected":"",a+='<div class="ls-item '+n+'" data-value="'+$(this).val()+'">'+$(this).text()+"</div>"})),t=$('<div class="lateselect-w"></div>'),$(this).wrap(t);var s=$(this).closest(".lateselect-w");s.append('<div class="ls-selected-items-w">'+o+"</div>"),s.append('<div class="ls-all-items-w">'+a+"</div>"),s.on("click",".ls-all-items-w .ls-item:not(.selected)",(function(){var t=$(this).data("value");return s.find(".ls-selected-items-w").append(e(s.find('select option[value="'+t+'"]'))),$(this).addClass("selected"),s.removeClass("ls-selecting"),s.find('select option[value="'+t+'"]').attr("selected",!0),s.find("select").trigger("change"),!1})),s.on("click",".ls-selected-items-w .ls-item-remover",(function(){var e=$(this).closest(".ls-item").data("value");return $(this).closest(".ls-item").remove(),s.find('.ls-all-items-w .ls-item.selected[data-value="'+e+'"]').removeClass("selected"),s.find('select option[value="'+e+'"]').removeAttr("selected"),s.find("select").trigger("change"),!1})),s.on("click",".ls-selected-items-w",(function(){return s.toggleClass("ls-selecting"),!1})),s.on("click",".os-late-quantity-selector",(function(){var e=$(this).closest(".ls-item").find("input.os-late-quantity-selector-input"),t=parseInt(e.val()),a="minus"==$(this).data("sign")?t-1:t+1,o=e.data("max-quantity");a<=0&&(a=1),o&&a>o&&(a=o);var n=$(this).closest(".ls-item").data("value");return s.find('select option[value="'+n+'"]').data("quantity",a),e.val(a),s.find("select").trigger("change"),!1})),$(this).on("change",(function(){if($(this).data("hidden-connection")){var e="";$(this).find("option:selected").length?$(this).find("option:selected").each((function(){var t=$(this).data("quantity")?$(this).data("quantity"):1;e+=$(this).val()+":"+t+","})):e="",""!=e&&(e=e.slice(0,-1)),$($(this).data("hidden-connection")).val(e)}}))}))}}(jQuery),jQuery(document).ready((function($){$(".latepoint").on("click","button[data-os-action], a[data-os-action], div[data-os-action], span[data-os-action]",(function(e){var t=$(this);if(t.data("os-prompt")&&!confirm(t.data("os-prompt")))return!1;var a=$(this).data("os-params");$(this).data("os-source-of-params")&&(a=$($(this).data("os-source-of-params")).find("select, input, textarea").serialize());var o=t.data("os-return-format")?t.data("os-return-format"):"json",n={action:"latepoint_route_call",route_name:$(this).data("os-action"),params:a,return_format:o};return t.addClass("os-loading"),$.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:n,success:function e(a){if("success"===a.status){if("lightbox"==t.data("os-output-target"))latepoint_show_data_in_lightbox(a.message,t.data("os-lightbox-classes"));else if("side-panel"==t.data("os-output-target"))$(".latepoint-side-panel-w").remove(),$("body").append('<div class="latepoint-side-panel-w"><div class="latepoint-side-panel-i">'+a.message+'</div><div class="latepoint-side-panel-shadow"></div></div>');else{if("reload"==t.data("os-success-action"))return latepoint_add_notification(a.message),void location.reload();if("redirect"==t.data("os-success-action"))return void(t.data("os-redirect-to")?(latepoint_add_notification(a.message),window.location.replace(t.data("os-redirect-to"))):window.location.replace(a.message));t.data("os-output-target")&&$(t.data("os-output-target")).length?"append"==t.data("os-output-target-do")?$(t.data("os-output-target")).append(a.message):$(t.data("os-output-target")).html(a.message):"before"==t.data("os-before-after")?t.before(a.message):"before"==t.data("os-before-after")?t.after(a.message):latepoint_add_notification(a.message)}if(t.data("os-after-call")){var o=t.data("os-after-call");t.data("os-pass-this")?window[o](t):t.data("os-pass-response")?window[o](a):window[o]()}t.removeClass("os-loading")}else t.removeClass("os-loading"),t.data("os-output-target")&&$(t.data("os-output-target")).length?$(t.data("os-output-target")).prepend(latepoint_generate_form_message_html(a.message,"error")):alert(a.message)}}),!1})),$(".latepoint").on("click",'form[data-os-action] button[type="submit"]',(function(e){$(this).addClass("os-loading")})),$(".latepoint").on("submit","form[data-os-action]",(function(e){e.preventDefault();var t=$(this),a=t.serialize(),o={action:"latepoint_route_call",route_name:$(this).data("os-action"),params:a,return_format:"json"};return t.find('button[type="submit"]').addClass("os-loading"),$.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function e(a){if(t.find('button[type="submit"].os-loading').removeClass("os-loading"),latepoint_clear_form_messages(t),"success"===a.status){if("reload"==t.data("os-success-action"))return latepoint_add_notification(a.message),void location.reload();if("redirect"==t.data("os-success-action"))return void(t.data("os-redirect-to")?(latepoint_add_notification(a.message),window.location.replace(t.data("os-redirect-to"))):window.location.replace(a.message));if(t.data("os-output-target")&&$(t.data("os-output-target")).length?$(t.data("os-output-target")).html(a.message):"redirect"==a.message?window.location.replace(a.url):(latepoint_add_notification(a.message),t.prepend(latepoint_generate_form_message_html(a.message,"success"))),t.data("os-record-id-holder")&&a.record_id&&t.find('[name="'+t.data("os-record-id-holder")+'"]').val(a.record_id),t.data("os-after-call")){var o=t.data("os-after-call");t.data("os-pass-response")?window[o](a):window[o]()}$("button.os-loading").removeClass("os-loading")}else $("button.os-loading").removeClass("os-loading"),t.data("os-show-errors-as-notification")?latepoint_add_notification(a.message,"error"):(t.prepend(latepoint_generate_form_message_html(a.message,"error")),$([document.documentElement,document.body]).animate({scrollTop:t.find(".os-form-message-w").offset().top-30},200));a.form_values_to_update&&$.each(a.form_values_to_update,(function(e,a){t.find('[name="'+e+'"]').val(a)}))}}),!1}))})),jQuery(document).ready((function($){latepoint_check_for_updates(),jQuery(".addons-info-holder").on("click",".os-addon-action-btn",(function(){var e=jQuery(this);e.addClass("os-loading");var t={action:"latepoint_route_call",route_name:e.data("route-name"),params:{addon_name:e.data("addon-name"),addon_path:e.data("addon-path")},layout:"none",return_format:"json"};return jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:t,success:function t(a){e.removeClass("os-loading"),"success"===a.status?(latepoint_add_notification(a.message),latepoint_load_addons_info()):"404"==a.code?latepoint_show_data_in_lightbox(a.message):alert(a.message)}}),!1}))}));var OsGoogleCalendar=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function e(){var t=this;gapi.load("client:auth2",(function(){gapi.client.init({clientId:latepoint_helper.google_calendar_client_id,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],scope:"https://www.googleapis.com/auth/calendar"}).then((function(){jQuery(".os-google-cal-authorize-btn").on("click",(function(){try{gapi.auth2.getAuthInstance().grantOfflineAccess().then(t.saveAuthCode)}catch(e){jQuery(".channel-watch-status").before(latepoint_generate_form_message_html(e.message,"error"))}return!1}))}),(function(e){jQuery(".channel-watch-status").before(latepoint_generate_form_message_html(e.details,"error"))}))}))}},{key:"saveAuthCode",value:function e(t){var a={code:t.code,agent_id:jQuery(".os-google-cal-authorize-btn").data("agent-id")},o={action:"latepoint_route_call",route_name:jQuery(".os-google-cal-authorize-btn").data("route"),params:a,layout:"none",return_format:"json"};jQuery.ajax({type:"POST",url:latepoint_helper.ajaxurl,dataType:"json",headers:{"X-Requested-With":"XMLHttpRequest"},data:o,success:function e(t){latepoint_add_notification(t.message),location.reload()}})}}]),e}();jQuery(document).ready((function($){latepoint_helper.google_calendar_is_enabled&&jQuery(".os-google-cal-authorize-btn").length&&(latepoint_helper.google_calendar=new OsGoogleCalendar,latepoint_helper.google_calendar.init()),latepoint_init_daily_agent_calendar(),latepoint_init_circles_charts(),latepoint_init_donut_charts(),latepoint_init_daily_bookings_chart(),latepoint_init_element_togglers(),latepoint_init_daterangepicker(jQuery(".os-date-range-picker")),latepoint_init_monthly_calendar_navigation(),latepoint_init_monthly_view(),latepoint_init_custom_fields_form(),latepoint_init_reminders_form(),latepoint_init_coupons_form(),latepoint_init_copy_on_click_elements(),latepoint_init_side_menu(),latepoint_init_color_picker(),jQuery(".os-select-all-toggler").on("change",(function(){var e=jQuery(this).closest(".white-box").find(".os-complex-connections-selector .connection");return $(this).is(":checked")?latepoint_complex_selector_select(e):latepoint_complex_selector_deselect(e),!1})),jQuery(".os-main-location-selector").on("change",(function(){var e,t,a={action:"latepoint_route_call",route_name:jQuery(this).data("route"),params:"id="+jQuery(this).val(),layout:"none",return_format:"json"};jQuery(".latepoint-content-w").addClass("os-loading"),jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:function e(t){location.reload()}})})),$(".os-service-durations-w").on("click",".os-remove-duration",(function(){return $(this).closest(".duration-box").slideUp(300,(function(){$(this).remove()})),!1})),$(".menu-color-toggler").on("click",(function(){return $(".latepoint-side-menu-w").toggleClass("dark"),!1})),$(".latepoint-mobile-top-menu-trigger").on("click",(function(){return $(this).closest(".latepoint-all-wrapper").toggleClass("os-show-mobile-menu"),$(this).closest(".latepoint-all-wrapper").hasClass("os-show-mobile-menu")?$(".latepoint-side-menu-w ul.side-menu > li.has-children > a").on("click",(function(){return $(this).closest("li").toggleClass("menu-item-sub-open-mobile"),!1})):$(".latepoint-side-menu-w ul.side-menu > li.has-children > a").off("click"),!1})),$(".latepoint-mobile-top-search-trigger-cancel").on("click",(function(){return $(this).closest(".latepoint-all-wrapper").removeClass("os-show-mobile-search"),!1})),$(".latepoint-mobile-top-search-trigger").on("click",(function(){return $(this).closest(".latepoint-all-wrapper").toggleClass("os-show-mobile-search"),$(this).closest(".latepoint-all-wrapper").hasClass("os-show-mobile-search")&&$(".latepoint-top-search").focus(),!1})),$(".latepoint-content").on("click",".os-widget-header-actions-trigger",(function(){return $(this).closest(".os-widget-header").toggleClass("os-show-actions"),!1})),$(".sync-all-bookings-to-google-trigger").on("click",(function(){return $(this).hasClass("os-syncing")?($(this).addClass("stop-syncing"),$(this).find("span").text($(this).data("label-sync"))):($(this).find("span").text($(this).data("label-cancel-sync")),$(this).addClass("os-syncing"),latepoint_sync_next_booking_with_google()),!1})),$(".remove-all-bookings-from-google-trigger").on("click",(function(){if($(this).hasClass("os-removing"))$(this).addClass("stop-removing"),$(this).find("span").text($(this).data("label-remove"));else{if(!confirm($(this).data("os-prompt")))return!1;$(this).find("span").text($(this).data("label-cancel-remove")),$(this).addClass("os-removing"),latepoint_remove_first_synced_booking_with_google()}return!1})),jQuery(".download-csv-with-filters").on("click",(function(){var e=jQuery(this).closest(".table-with-pagination-w").find(".os-table-filter").serialize();e+="&download=csv",jQuery(this).attr("href",this.href+"&"+e)})),$("select.pagination-page-select").on("change",(function(){latepoint_filter_table(jQuery(this).closest(".table-with-pagination-w").find("table"),jQuery(this).closest(".pagination-page-select-w"),!1)})),$("select.os-table-filter").on("change",(function(){latepoint_filter_table(jQuery(this).closest("table"),jQuery(this).closest(".os-form-group"))})),$("input.os-table-filter").on("keyup",(function(){latepoint_filter_table(jQuery(this).closest("table"),jQuery(this).closest(".os-form-group"))})),jQuery(".customize-connection-btn").on("click",(function(){return jQuery(this).closest(".connection").toggleClass("show-customize-box"),!1})),jQuery(".connection-children-list").on("click","li",(function(){return jQuery(this).hasClass("active")?(jQuery(this).removeClass("active"),jQuery(this).find("input.connection-child-is-connected").val("no")):(jQuery(this).addClass("active"),jQuery(this).find("input.connection-child-is-connected").val("yes")),latepoint_count_active_connections(jQuery(this).closest(".connection")),!1})),jQuery(".display-toggler-control").on("change",(function(){var e=jQuery(this).data("toggler-group"),t=jQuery(this).val();return jQuery('.display-toggler-target[data-toggler-group="'+e+'"]').hide(),jQuery('.display-toggler-target[data-toggler-group="'+e+'"][data-toggler-key="'+t+'"]').show(),!1})),jQuery(".add-item-category-trigger").on("click",(function(){return $(".add-item-category-box").toggle(),$(".os-new-item-category-form-w").toggle(),!1})),jQuery(".latepoint-top-search").on("keyup",(function(e){var t=jQuery(this).closest(".latepoint-top-search-w");t.addClass("os-loading");var a=jQuery(this).val();if(27==e.keyCode)return t.removeClass("typing"),jQuery(".latepoint-top-search-results-w").html(""),jQuery(this).val(""),void t.removeClass("os-loading");if(""==a)return t.removeClass("typing"),jQuery(".latepoint-top-search-results-w").html(""),void t.removeClass("os-loading");var o,n,s={action:"latepoint_route_call",route_name:jQuery(this).data("route"),params:"query="+a,layout:"none",return_format:"json"};t.addClass("typing"),jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:s,success:function e(a){t.hasClass("typing")&&(t.removeClass("os-loading"),"success"===a.status&&jQuery(".latepoint-top-search-results-w").html(a.message))}})})),jQuery(".add-custom-step-btn").on("click",(function(e){var t=jQuery(".empty-step-w .step-w").clone(),a="step_"+latepoint_random_text(6),o=$(".steps-ordering-w .step-w").length;return t.find('input[name="step[name]"]').val(a),t.find('input[name="step[order_number]"]').val(o),t.addClass("editing").attr("data-step-name",a),jQuery(".steps-ordering-w").append(t),!1})),jQuery(".appointment-status-selector").on("click",(function(e){e.stopPropagation()})),jQuery(".latepoint-show-license-details").on("click",(function(e){return jQuery(this).closest(".active-license-info").find(".license-form-w").slideToggle(200),!1})),jQuery(".aba-button-w").on("click",(function(e){e.stopPropagation();var t=jQuery(this).hasClass("aba-approve")?latepoint_helper.approve_confirm:latepoint_helper.reject_confirm,a;confirm(t)&&jQuery(this).closest(".appointment-box-large").find(".appointment-status-selector select").val(jQuery(this).data("status")).change();return!1})),jQuery("select.agent_google_calendar_selector").on("change",(function(e){var t,a,o,n={action:"latepoint_route_call",route_name:$(this).data("route"),params:{calendar_id:$(this).val(),agent_id:$(this).data("agent-id")},layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:n,success:function e(t){"success"===t.status&&latepoint_add_notification(t.message)}})})),jQuery(".appointment-status-selector select").on("change",(function(e){var t=jQuery(this).closest(".appointment-status-selector"),a=t.data("route"),o=t.data("booking-id"),n=jQuery(this).val();jQuery(this).closest(".appointment-box-large").attr("class","appointment-box-large status-"+n);var s,i={action:"latepoint_route_call",route_name:a,params:"id="+o+"&status="+n,layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:i,success:function e(t){"success"===t.status&&latepoint_add_notification(t.message)}})})),jQuery("body").on("click",".open-template-variables-panel",(function(){return jQuery(".latepoint-template-variables").toggleClass("is-visible"),!1})),jQuery("body").on("click",".close-template-variables-panel",(function(){return jQuery(".latepoint-template-variables").removeClass("is-visible"),!1})),jQuery("body").on("click",".os-notifications .os-notification-close",(function(){return jQuery(this).closest(".item").remove(),!1})),jQuery("body").on("keyup",".os-form-group .os-form-control",(function(){jQuery(this).val()?jQuery(this).closest(".os-form-group").addClass("has-value"):jQuery(this).closest(".os-form-group").removeClass("has-value")})),jQuery(".os-wizard-setup-w, .latepoint-settings-w, .custom-schedule-wrapper").on("click",".ws-head",(function(){var e=jQuery(this).closest(".weekday-schedule-w");e.toggleClass("is-editing").removeClass("day-off"),e.find(".os-toggler").removeClass("off"),e.find("input.is-active").val(1)})),latepoint_mask_timefield(jQuery(".os-mask-time")),latepoint_mask_phone(jQuery(".os-mask-phone")),jQuery(".latepoint").on("click",".wizard-add-edit-item-trigger",(function(e){jQuery(this).addClass("os-loading");var t=jQuery(this).data("route"),a={};jQuery(this).data("id")&&(a.id=jQuery(this).data("id"));var o={action:"latepoint_route_call",route_name:t,params:a,layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function e(t){jQuery(".wizard-add-edit-item-trigger.os-loading").removeClass("os-loading"),"success"===t.status&&(jQuery(".os-wizard-step-content-i").html(t.message),jQuery(".os-wizard-setup-w").addClass("is-sub-editing"),jQuery(".os-wizard-footer").hide())}})})),jQuery(".latepoint").on("click",".os-wizard-next-btn",(function(){var e=jQuery(this);e.addClass("os-loading");var t,a="current_step="+jQuery("#wizard_current_step").val()
;jQuery(".os-wizard-setup-w form.weekday-schedules-w").length&&(a+="&"+jQuery(".os-wizard-setup-w form.weekday-schedules-w .weekday-schedule-w:not(.day-off) input").serialize());var o={action:"latepoint_route_call",route_name:jQuery(this).data("route-name"),params:a,layout:"none",return_format:"json"};return jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function t(a){e.removeClass("os-loading"),"success"===a.status&&(jQuery("#wizard_current_step").val(a.step_name),jQuery(".os-wizard-setup-w").attr("class","os-wizard-setup-w step-"+a.step_name),jQuery(".os-wizard-step-content").html(a.message),a.show_prev_btn?jQuery(".os-wizard-prev-btn").show():jQuery(".os-wizard-prev-btn").hide(),a.show_next_btn?jQuery(".os-wizard-next-btn").show():jQuery(".os-wizard-next-btn").hide(),a.show_next_btn||a.show_prev_btn?jQuery(".os-wizard-footer").show():jQuery(".os-wizard-footer").hide())}}),!1})),jQuery(".latepoint").on("click",".os-wizard-prev-btn",(function(){var e=jQuery(this);e.addClass("os-loading");var t,a="current_step="+jQuery("#wizard_current_step").val(),o={action:"latepoint_route_call",route_name:jQuery(this).data("route-name"),params:a,layout:"none",return_format:"json"};return jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function t(a){e.removeClass("os-loading"),"success"===a.status&&(jQuery("#wizard_current_step").val(a.step_name),jQuery(".os-wizard-setup-w").attr("class","os-wizard-setup-w step-"+a.step_name),jQuery(".os-wizard-step-content").html(a.message),a.show_prev_btn?jQuery(".os-wizard-prev-btn").show():jQuery(".os-wizard-prev-btn").hide(),a.show_next_btn?jQuery(".os-wizard-next-btn").show():jQuery(".os-wizard-next-btn").hide(),a.show_next_btn||a.show_prev_btn?jQuery(".os-wizard-footer").show():jQuery(".os-wizard-footer").hide())}}),!1})),jQuery(".latepoint-content-w").on("change",".os-widget .os-trigger-reload-widget",(function(){latepoint_reload_widget(jQuery(this).closest(".os-widget"))})),dragula([].slice.apply(document.querySelectorAll(".os-categories-ordering-w .os-category-children")),{moves:function e(t,a,o){return o.classList.contains("os-category-drag")||o.classList.contains("os-category-item-drag")}}).on("drop",(function(e){var t=jQuery(".os-categories-ordering-w"),a=[],o=[];t.find(".os-category-parent-w").each((function(e){var t=jQuery(this).index()+1,o=jQuery(this).parent().closest(".os-category-parent-w").data("id")||0;a.push({id:jQuery(this).data("id"),order_number:t,parent_id:o})})),t.find(".item-in-category-w").each((function(e){var t=jQuery(this).index()+1,a=jQuery(this).closest(".os-category-parent-w").data("id")||0;o.push({id:jQuery(this).data("id"),order_number:t,category_id:a})})),latepoint_recalculate_items_count_in_category();var n={action:"latepoint_route_call",route_name:t.data("category-order-update-route"),params:{category_datas:a,item_datas:o},return_format:"json"};t.addClass("os-loading"),jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:n,success:function e(a){t.removeClass("os-loading"),"success"===a.status||alert(a.message)}})})),dragula([jQuery(".os-custom-fields-ordering-w")[0]],{moves:function e(t,a,o){return o.classList.contains("os-custom-field-drag")}}).on("drop",(function(e){var t={},a=jQuery(".os-custom-fields-ordering-w");a.find(".os-custom-field-form").each((function(e){var a=jQuery(this).index()+1,o=jQuery(this).find(".os-custom-field-id");o.length&&o.val()&&(t[o.val()]=a)}));var o={action:"latepoint_route_call",route_name:a.data("order-update-route"),params:{ordered_fields:t,fields_for:a.data("fields-for")},return_format:"json"};a.addClass("os-loading"),jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function e(t){a.removeClass("os-loading")}})})),dragula([jQuery(".steps-ordering-w")[0]],{moves:function e(t,a,o){return o.classList.contains("step-drag")}}).on("drop",(function(e){var t={},a=jQuery(".steps-ordering-w");a.find(".step-w").each((function(e){var a=jQuery(this).index()+1;jQuery(this).data("step-order-number",a),jQuery(this).find('input[name="step[order_number]"]').val(a),t[jQuery(this).data("step-name")]=a}));var o={action:"latepoint_route_call",route_name:a.data("step-order-update-route"),params:{steps:t},return_format:"json"};a.addClass("os-loading"),jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function e(t){a.removeClass("os-loading")}})})),jQuery("body.latepoint-admin").on("click",".os-category-edit-btn, .os-category-edit-cancel-btn, .os-category-w .os-category-name",(function(){return jQuery(this).closest(".os-category-w").toggleClass("editing"),!1})),jQuery("body.latepoint-admin").on("click",".step-edit-btn, .step-edit-cancel-btn, .step-w .step-name",(function(){return jQuery(this).closest(".step-w").toggleClass("editing"),!1})),jQuery("body.latepoint-admin").on("click",".agent-info-change-agent-btn",(function(){return jQuery(this).closest(".agent-info-w").removeClass("selected").addClass("selecting"),!1})),jQuery("body.latepoint-admin").on("click",".agent-info-change-agent-btn",(function(){return jQuery(this).closest(".agent-info-w").removeClass("selected").addClass("selecting"),!1})),jQuery("body.latepoint-admin").on("click",".customer-info-create-btn",(function(){return jQuery(this).closest(".customer-info-w").removeClass("selecting").addClass("selected"),!1})),jQuery("body.latepoint-admin").on("click",".customer-info-load-btn",(function(){return jQuery(this).closest(".customer-info-w").removeClass("selected").addClass("selecting").find(".customers-selector-search-input").focus(),!1})),jQuery("body.latepoint-admin").on("click",".customers-selector-cancel",(function(){return jQuery(this).closest(".customer-info-w").removeClass("selecting").addClass("selected "),jQuery(".customers-options-list .customer-option").show(),jQuery(".customers-selector-search-input").val(""),!1})),jQuery("body.latepoint-admin").on("click",".os-services-select-field-w .service-option-selected",(function(){var e=jQuery(this).closest(".os-services-select-field-w");return e.hasClass("active")?e.removeClass("active"):e.addClass("active").find("input").focus(),!1})),jQuery("body.latepoint-admin").on("click",".os-services-select-field-w service-option-selected",(function(){return!1})),jQuery("body.latepoint-admin").on("keyup",".service-options-filter-input",(function(){var e=jQuery(this).closest(".services-options-list"),t=jQuery(this).val().toLowerCase();return e.find(".service-option").hide(),e.find(".service-option").each((function(){-1!=jQuery(this).text().toLowerCase().indexOf(""+t)&&jQuery(this).show()})),!1})),jQuery(".calendar-week-agent-w").on("click",".calendar-load-target-date",(function(e){return jQuery(this).addClass("os-loading"),latepoint_load_calendar(jQuery(this).data("target-date"),jQuery(".calendar-agent-selector").val(),jQuery(".calendar-location-selector").val()),!1})),jQuery(".calendar-week-agent-w").on("change",".calendar-agent-selector",(function(e){return latepoint_load_calendar(jQuery(".calendar-start-date").val(),jQuery(".calendar-agent-selector").val(),jQuery(".calendar-location-selector").val()),!1})),jQuery(".calendar-week-agent-w").on("change",".calendar-location-selector",(function(e){return latepoint_load_calendar(jQuery(".calendar-start-date").val(),jQuery(".calendar-agent-selector").val(),jQuery(".calendar-location-selector").val()),!1})),jQuery(".latepoint-admin").on("click",".os-complex-connections-selector .selector-trigger",(function(){var e=jQuery(this).closest(".connection");return e.hasClass("active")?(latepoint_complex_selector_deselect(e),jQuery(this).closest(".white-box").find(".os-select-all-toggler").prop("checked",!1)):latepoint_complex_selector_select(e),!1})),jQuery(".latepoint-admin").on("click",".os-agents-selector .agent",(function(){return jQuery(this).hasClass("active")?(jQuery(this).removeClass("active"),jQuery(this).find(".connection-child-is-connected").val("no")):(jQuery(this).addClass("active"),jQuery(this).find(".connection-child-is-connected").val("yes")),!1})),jQuery(".latepoint-admin").on("click",".os-services-selector .service",(function(){return jQuery(this).hasClass("active")?(jQuery(this).removeClass("active"),jQuery(this).find(".connection-child-is-connected").val("no")):(jQuery(this).addClass("active"),jQuery(this).find(".connection-child-is-connected").val("yes")),!1})),jQuery(".latepoint-admin").on("click",".os-form-toggler-group label",(function(e){return jQuery(this).closest(".os-form-toggler-group").find(".os-toggler").click(),!1})),jQuery(".latepoint-admin").on("click",".os-toggler",(function(e){if(jQuery(this).toggleClass("off"),jQuery(this).data("for")){var t=$('input[type="hidden"]#'+jQuery(this).data("for"));t.length?jQuery(this).data("is-string-value")?t.val(jQuery(this).hasClass("off")?"off":"on"):t.val(jQuery(this).hasClass("off")?0:1):$("#"+jQuery(this).data("for")).prop("checked",!jQuery(this).hasClass("off"))}return jQuery(this).data("controlled-toggle-id")&&(jQuery(this).hasClass("off")?$("#"+jQuery(this).data("controlled-toggle-id")).hide():$("#"+jQuery(this).data("controlled-toggle-id")).show()),jQuery(this).trigger("ostoggler:toggle"),!1})),jQuery(".latepoint-admin").on("click",".os-image-selector-trigger",(function(e){var t;e.preventDefault();var a=jQuery(this),o=jQuery(this).closest(".os-image-selector-w"),n=o.find(".os-image-container"),s=o.find(".os-image-id-holder"),i;if(n.find("img").length)s.val(""),n.removeClass("has-image"),n.html(""),a.find(".os-text-holder").text(a.data("label-set-str"));else{if(t)return t.open(),!1;(t=wp.media({title:"Select or Upload Media",button:{text:"Use this media"},multiple:!1})).on("select",(function(){var e=t.state().get("selection").first().toJSON();n.append('<img src="'+e.url+'" alt=""/>'),s.val(e.id),n.addClass("has-image"),a.find(".os-text-holder").text(a.data("label-remove-str"))})),t.open()}return!1})),jQuery("body").on("click",".latepoint-lightbox-close",(function(){return latepoint_lightbox_close(),!1})),jQuery("body").on("click",".latepoint-side-panel-close-trigger",(function(){return jQuery(".latepoint-side-panel-w").remove(),!1})),jQuery("body").on("click",".latepoint-quick-availability-close",(function(){return jQuery(".quick-availability-per-day-w").remove(),!1})),jQuery("body.latepoint-admin").on("click",".time-ampm-select",(function(){jQuery(this).closest(".time-ampm-w").find(".active").removeClass("active"),jQuery(this).addClass("active");var e=jQuery(this).data("ampm-value");return jQuery(this).closest(".os-time-group").find(".ampm-value-hidden-holder").val(e),!1})),jQuery("body.latepoint-admin").on("click",".latepoint-lightbox-shadow",(function(){return latepoint_lightbox_close(),!1})),jQuery("body.latepoint-admin").on("click",".latepoint-side-panel-shadow",(function(){return jQuery(".latepoint-side-panel-w").remove(),!1})),jQuery("body.latepoint-admin").on("click",".ws-period-remove",(function(e){return jQuery(this).closest(".ws-period").remove(),!1})),jQuery(".latepoint-admin").on("click",".weekday-schedule-w .os-toggler",(function(e){return jQuery(this).hasClass("off")?jQuery(this).closest(".weekday-schedule-w").addClass("day-off").removeClass("is-editing").find("input.is-active").val(0):jQuery(this).closest(".weekday-schedule-w").removeClass("day-off").addClass("is-editing").find("input.is-active").val(1),!1}))}));
//# sourceMappingURL=main_back.js.map